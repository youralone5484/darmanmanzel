<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>داشبورد کاربر - درمان‌منزل</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
    }
    .status-badge {
      font-size: 0.75rem;
      padding: 0.35rem 0.7rem;
      border-radius: 50px;
    }
    .active-request {
      border-right: 4px solid;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { border-right-color: #10b981; }
      50% { border-right-color: #a7f3d0; }
      100% { border-right-color: #10b981; }
    }
  </style>
</head>
<body class="bg-gray-50">

  <!-- هدر -->
  <header class="bg-gradient-to-l from-green-600 to-green-700 text-white shadow-lg">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-3 space-x-reverse">
        <i class="fas fa-home-medical text-xl"></i>
        <h1 class="text-xl font-bold">درمان‌منزل</h1>
      </div>
      <div class="flex items-center space-x-4 space-x-reverse">
        <div class="text-sm hidden md:block">
          <span id="current-date-time" class="dir-ltr"></span>
        </div>
        <div class="relative">
          <button id="notification-btn" class="relative p-1 rounded-full hover:bg-green-500">
            <i class="far fa-bell text-lg"></i>
            <span class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs">3</span>
          </button>
          <div id="notification-dropdown" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-10 p-2 border border-gray-200">
            <!-- محتوای نوتیفیکیشن‌ها -->
          </div>
        </div>
        <a href="profile.html" class="text-sm bg-white text-green-700 px-3 py-1 rounded hover:bg-gray-100 transition">
          <i class="fas fa-user-circle mr-1"></i> پروفایل
        </a>
        <a href="#" id="logout-btn" class="text-sm bg-red-100 text-red-700 px-3 py-1 rounded hover:bg-red-200 transition">
          <i class="fas fa-sign-out-alt mr-1"></i> خروج
        </a>
      </div>
    </div>
  </header>

  <!-- محتوای اصلی -->
  <main class="container mx-auto px-4 py-6">
    <!-- کارت وضعیت درخواست فعال -->
    <div id="active-request-container" class="bg-white rounded-xl shadow-md p-6 mb-6 active-request">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
        <div class="mb-4 md:mb-0">
          <h2 class="text-lg font-bold mb-2 flex items-center">
            <i class="fas fa-ambulance ml-2 text-green-600"></i>
            <span id="active-request-title">درخواست جاری</span>
          </h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
            <p class="text-gray-600">
              <i class="fas fa-procedures ml-1"></i>
              <span id="service-type">نوع خدمت: در حال بارگذاری...</span>
            </p>
            <p class="text-gray-600">
              <i class="far fa-calendar-alt ml-1"></i>
              <span id="request-date">تاریخ: -</span>
            </p>
            <p class="text-gray-600">
              <i class="far fa-clock ml-1"></i>
              <span id="request-time">ساعت: -</span>
            </p>
            <p class="text-gray-600">
              <i class="fas fa-info-circle ml-1"></i>
              وضعیت: <span id="request-status" class="font-bold">-</span>
            </p>
          </div>
        </div>
        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 space-x-reverse w-full md:w-auto">
          <button id="track-doctor-btn" class="bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm hover:bg-green-200 transition flex items-center justify-center">
            <i class="fas fa-map-marked-alt ml-1"></i>
            ردیابی پزشک
          </button>
          <button id="support-chat-btn" class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm hover:bg-blue-200 transition flex items-center justify-center">
            <i class="far fa-comments ml-1"></i>
            چت با پشتیبانی
          </button>
          <button id="cancel-request-btn" class="bg-red-100 text-red-700 px-4 py-2 rounded-lg text-sm hover:bg-red-200 transition flex items-center justify-center">
            <i class="fas fa-times ml-1"></i>
            لغو درخواست
          </button>
        </div>
      </div>
      
      <!-- جزئیات پزشک (در صورت وجود) -->
      <div id="doctor-details" class="hidden mt-4 pt-4 border-t border-gray-200">
        <h3 class="font-semibold mb-2 flex items-center">
          <i class="fas fa-user-md ml-2 text-blue-600"></i>
          اطلاعات پزشک
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <div>
            <p class="text-gray-600">نام پزشک:</p>
            <p id="doctor-name" class="font-medium">-</p>
          </div>
          <div>
            <p class="text-gray-600">تخصص:</p>
            <p id="doctor-specialty" class="font-medium">-</p>
          </div>
          <div>
            <p class="text-gray-600">شماره تماس:</p>
            <p id="doctor-phone" class="font-medium">-</p>
          </div>
        </div>
      </div>
    </div>

    <!-- بخش خدمات سریع -->
    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
      <h3 class="text-lg font-bold mb-4 flex items-center">
        <i class="fas fa-plus-circle ml-2 text-green-600"></i>
        ثبت درخواست جدید
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <a href="new-request.html?type=doctor" class="service-card bg-white rounded-lg shadow-md p-5 text-center cursor-pointer hover:shadow-lg transition border border-gray-200 hover:border-green-300">
          <div class="text-4xl mb-3 text-green-600"><i class="fas fa-user-md"></i></div>
          <h4 class="font-semibold mb-2">پزشک عمومی</h4>
          <p class="text-sm text-gray-600 mb-3">ویزیت در منزل</p>
          <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">سرویس فوری</span>
        </a>
        
        <a href="new-request.html?type=nurse-elderly" class="service-card bg-white rounded-lg shadow-md p-5 text-center cursor-pointer hover:shadow-lg transition border border-gray-200 hover:border-blue-300">
          <div class="text-4xl mb-3 text-blue-600"><i class="fas fa-user-nurse"></i></div>
          <h4 class="font-semibold mb-2">پرستار سالمند</h4>
          <p class="text-sm text-gray-600 mb-3">مراقبت روزانه</p>
          <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">محبوب</span>
        </a>
        
        <a href="new-request.html?type=nurse-child" class="service-card bg-white rounded-lg shadow-md p-5 text-center cursor-pointer hover:shadow-lg transition border border-gray-200 hover:border-purple-300">
          <div class="text-4xl mb-3 text-purple-600"><i class="fas fa-baby"></i></div>
          <h4 class="font-semibold mb-2">پرستار کودک</h4>
          <p class="text-sm text-gray-600 mb-3">مراقبت تخصصی</p>
          <span class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">جدید</span>
        </a>
      </div>
    </div>

    <!-- تاریخچه درخواست‌ها -->
    <div class="bg-white rounded-xl shadow-md overflow-hidden">
      <div class="p-6">
        <h3 class="text-lg font-bold mb-4 flex items-center">
          <i class="fas fa-history ml-2 text-gray-600"></i>
          تاریخچه درخواست‌ها
        </h3>
        
        <div class="overflow-x-auto">
          <table class="w-full min-w-max">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-right text-sm font-medium text-gray-500">شماره درخواست</th>
                <th class="px-4 py-3 text-sm font-medium text-gray-500">نوع خدمت</th>
                <th class="px-4 py-3 text-sm font-medium text-gray-500">تاریخ</th>
                <th class="px-4 py-3 text-sm font-medium text-gray-500">پزشک/پرستار</th>
                <th class="px-4 py-3 text-sm font-medium text-gray-500">وضعیت</th>
                <th class="px-4 py-3 text-sm font-medium text-gray-500">عملیات</th>
              </tr>
            </thead>
            <tbody id="requests-history" class="divide-y divide-gray-200">
              <!-- داده‌ها به صورت داینامیک از API دریافت می‌شوند -->
              <tr>
                <td colspan="6" class="px-4 py-6 text-center text-gray-500">
                  <i class="fas fa-spinner fa-spin mr-2"></i>
                  در حال بارگذاری تاریخچه درخواست‌ها...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="mt-4 flex justify-between items-center">
          <div class="text-sm text-gray-500">
            نمایش <span id="start-item">1</span> تا <span id="end-item">5</span> از <span id="total-items">0</span> درخواست
          </div>
          <div class="flex space-x-2 space-x-reverse">
            <button id="prev-page" class="px-3 py-1 border rounded text-gray-600 disabled:opacity-50">
              <i class="fas fa-chevron-right"></i>
            </button>
            <button id="next-page" class="px-3 py-1 border rounded text-gray-600 disabled:opacity-50">
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- پاورقی -->
  <footer class="bg-gray-800 text-white py-6 mt-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h4 class="font-bold mb-3">درمان‌منزل</h4>
          <p class="text-sm text-gray-300">ارائه خدمات درمانی و مراقبتی در منزل با بالاترین کیفیت</p>
        </div>
        <div>
          <h4 class="font-bold mb-3">لینک‌های سریع</h4>
          <ul class="space-y-2 text-sm text-gray-300">
            <li><a href="#" class="hover:text-white transition">شرایط و ضوابط</a></li>
            <li><a href="#" class="hover:text-white transition">حریم خصوصی</a></li>
            <li><a href="#" class="hover:text-white transition">سوالات متداول</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-3">تماس با ما</h4>
          <ul class="space-y-2 text-sm text-gray-300">
            <li class="flex items-center">
              <i class="fas fa-phone ml-2"></i>
              <span>۰۹۱۲XXXXXXX</span>
            </li>
            <li class="flex items-center">
              <i class="far fa-envelope ml-2"></i>
              <span>info@darmanmanzel.ir</span>
            </li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-3">پیگیری درخواست</h4>
          <div class="flex">
            <input type="text" placeholder="شماره درخواست" class="px-3 py-2 rounded-l text-sm w-full text-gray-800">
            <button class="bg-green-600 hover:bg-green-700 px-3 rounded-r">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-700 mt-6 pt-6 text-center text-sm text-gray-400">
        <p>© تمامی حقوق برای درمان‌منزل محفوظ است - ۱۴۰۲</p>
      </div>
    </div>
  </footer>

  <!-- اسکریپت‌های سیستمی -->
<script>
  // ==================== نسخه تست بدون نیاز به بک‌اند ====================
  document.addEventListener('DOMContentLoaded', function() {
    // داده‌های آزمایشی
    const mockData = {
      active_request: {
        service_type: "پزشک عمومی",
        date: "2023-08-16",
        time: "14:30",
        status: "در حال اعزام",
        doctor: {
          name: "دکتر رضوی",
          specialty: "پزشک عمومی",
          phone: "0912XXX5678"
        }
      },
      requests_history: [
        {id: "1001", service_type: "پرستار کودک", date: "2023-08-10", doctor: "پرستار مریم", status: "تکمیل شده"},
        {id: "1002", service_type: "پزشک عمومی", date: "2023-08-05", doctor: "دکتر حسنی", status: "تکمیل شده"}
      ]
    };

    // نمایش داده‌های آزمایشی
    updateDashboard(mockData);
    updateDateTime();
    
    // به‌روزرسانی خودکار زمان هر دقیقه
    setInterval(updateDateTime, 60000);
  });

  // تابع نمایش اطلاعات
  function updateDashboard(data) {
    // نمایش درخواست فعال
    if (data.active_request) {
      document.getElementById('service-type').textContent = `نوع خدمت: ${data.active_request.service_type}`;
      document.getElementById('request-date').textContent = `تاریخ: ${data.active_request.date}`;
      document.getElementById('request-time').textContent = `ساعت: ${data.active_request.time}`;
      document.getElementById('request-status').textContent = data.active_request.status;
      document.getElementById('request-status').className = getStatusClass(data.active_request.status);
      
      if (data.active_request.doctor) {
        document.getElementById('doctor-details').classList.remove('hidden');
        document.getElementById('doctor-name').textContent = data.active_request.doctor.name;
        document.getElementById('doctor-specialty').textContent = data.active_request.doctor.specialty;
        document.getElementById('doctor-phone').textContent = data.active_request.doctor.phone;
      }
    }
    
    // نمایش تاریخچه
    const historyContainer = document.getElementById('requests-history');
    historyContainer.innerHTML = '';
    
    data.requests_history.forEach(request => {
      const row = document.createElement('tr');
      row.className = 'hover:bg-gray-50';
      row.innerHTML = `
        <td class="px-4 py-3 text-sm font-medium">#${request.id}</td>
        <td class="px-4 py-3 text-sm text-gray-500">${request.service_type}</td>
        <td class="px-4 py-3 text-sm text-gray-500">${request.date}</td>
        <td class="px-4 py-3 text-sm text-gray-500">${request.doctor}</td>
        <td class="px-4 py-3 text-sm">
          <span class="${getStatusClass(request.status)} status-badge">${request.status}</span>
        </td>
      `;
      historyContainer.appendChild(row);
    });
  }

  // تابع وضعیت‌ها
  function getStatusClass(status) {
    const classes = {
      'تکمیل شده': 'bg-green-100 text-green-800',
      'در حال انجام': 'bg-yellow-100 text-yellow-800',
      'در حال اعزام': 'bg-blue-100 text-blue-800'
    };
    return classes[status] || 'bg-gray-100 text-gray-800';
  }

  // تابع تاریخ و زمان
  function updateDateTime() {
    const now = new Date().toLocaleString('fa-IR');
    document.getElementById('current-date-time').textContent = now;
  }
</script>